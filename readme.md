
LadyPHP - type PHP with elegance
================================

Simple (and stupid) preprocessor for PHP. Main purpose of this is making source code a little more beautiful.

- optional `;` at end of line
- variables doesn't have to be prefixed with `$`, but it must starts with a lowercase letter
- indent style, no need for `{` and `}`
- `.` is converted to `->` or `::`, but not if it's surrounded by spaces
- `:` is converted to `=>`, but only if there isn't space before it
- `fn foo()` is converted to `function foo()`
- `Foo\Bar()` is converted to `new Foo\Bar()`
- optional `:` after `case ...` and `default`
- `<?` and `<?=` are converted to `<?php` and `<?php echo`
- original line numbers are preserved (handy for debugging)
- Lady herself is written in Lady, use the source for reference

## Usage

    <?php
    require_once('lady.php');
    Lady::includeFile('example.lady', 'cache/example.php');

## Example

#### LadyPHP

    <?

    class Fruit
      var apples = 0
      var numbers = [
        1: 'one',
        2: 'two',
        3: 'three'
      ]

      fn addApples(n = 1)
        if (n >= 0)
          this.apples += n
        return this

      fn countApples()
        apples = this.apples
        out = 'You have '
        out .= isset(this.numbers[apples])
               ? this.numbers[apples] : apples
        switch (apples)
          case 1
            return out . ' apple.'
          default
            return "$out apples."

    fruit = Fruit()
    fruit.addApples(1)
         .addApples(2)
    ?>
    <p><?=fruit.countApples()?></p>

#### PHP

    <?php /* DO NOT EDIT THIS FILE. It was generated by LadyPHP. */

    class Fruit{
      var $apples = 0;
      var $numbers = [
        1 => 'one',
        2 => 'two',
        3 => 'three'
      ];

      function addApples($n = 1){
        if ($n >= 0){
          $this->apples += $n;}
        return $this;}

      function countApples(){
        $apples = $this->apples;
        $out = 'You have ';
        $out .= isset($this->numbers[$apples])
               ? $this->numbers[$apples] : $apples;
        switch ($apples){
          case 1:
            return $out . ' apple.';
          default:
            return "$out apples.";}}}

    $fruit = new Fruit();
    $fruit->addApples(1)
         ->addApples(2);
    ?>
    <p><?php echo $fruit->countApples()?></p>

#### Output

    <p>You have three apples.</p>

## API

### Flags

- `Lady::COMPRESS` - compress php code
- `Lady::NOCACHE` - always overwrite cache file

### Lady::parse()

    Lady::parse(string $source, int $flags = 0)

Convert LadyPHP from string and return PHP code.

### Lady::parseFile()

    Lady::parseFile(string $file, string $cacheFile = null, int $flags = 0)

If `cacheFile` is null, convert LadyPHP from file and return PHP code.

If `cacheFile` is set, then check if `cacheFile` if newer then `file`.
If it's older, parse `file` and save PHP code to `cacheFile`. Then return content of `cacheFile`.

### Lady::includeFile()

    Lady::includeFile(string $file, string $cacheFile = null, int $flags = 0)

If `cacheFile` is null, convert LadyPHP from file and execute output.

If `cacheFile` is set, then check if `cacheFile` if newer then `file`.
If it's older, parse `file` and save PHP code to `cacheFile`. Then include `cacheFile`.

### Lady::testFile()

    Lady::testFile(string $file, int $flags = 0)

Parse file and show input and output as html.

### Lady::compress()

    Lady::compress(string $php)

Helper function to remove comments and whitespaces from PHP code.
